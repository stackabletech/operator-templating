---
- name: "Playing with Ansible and Git"
  hosts: localhost
  connection: local

  tasks:
    - name: Show workdir
      debug:
        msg: "{{ work_dir }}"

    - name: Ensure work directory exists
      file:
        path: "{{ work_dir }}"
        state: directory

    - name: "Update repositories from templates"
      include: "update_repo.yaml"
      with_items: "{{ repositories }}"

    - name: "List directory"
      shell: tree {{ work_dir }}
      register: dirtree

    - name: Show tree
      debug:
        msg: "{{ dirtree }}"
